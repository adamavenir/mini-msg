import { @agent, @triggerMsgIDs } from @payload

exe @fray(args) = cmd { fray @args --json }
exe @safe(obj, field) = js { return (obj && obj[field]) || [] }
exe @at(name) = js { return "@" + name }

>> Minimal context for quick hop-in tasks
var @mentionsData = @fray(`@$@agent --last 3`)
var @mentionsList = @safe(@mentionsData, "mentions")

var @prompt = `**You are @at(@agent).** Quick hop-in task.

## Trigger
Messages: @triggerMsgIDs

## Recent @mentions
/for @m in @mentionsList
- [@m.id] @m.from_agent: @m.body
/end

---
Complete this task efficiently. Run "fray bye @agent" when done.

If you go idle without completing, your session will end automatically.

IMPORTANT: Users only see fray messages. Post progress updates to fray.`

show @prompt

export { @prompt }
