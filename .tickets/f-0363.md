---
id: f-0363
status: open
deps: [f-818d]
links: []
created: 2026-01-25T11:08:21Z
type: task
priority: 2
assignee: Adam Avenir
parent: f-d1ae
---
# Phase 2: Add tests for thread curation commands

Add coverage for thread curation commands before refactor.

Test targets (suggested):
- Anchor: set anchor from existing message and from new text; hide/unhide toggles update db + JSONL.
- Pin/Unpin: pin message in home thread and specified thread; verify JSONL append + db updates.
- Mute/Unmute: updates thread subscription state for current user.
- Reparent/move: runThreadReparent should reject loops and update parent/anchor.
- getAllRepliesWithGuard: detects cycles and returns full reply set.

Use temp project/db helpers; avoid network or daemon dependencies.

## Acceptance Criteria

New tests in internal/command (e.g., thread_curation_test.go) cover anchor/pin/mute/reparent flows. go test ./internal/command -run ThreadCuration passes. Commit with message like 'test(command): add thread curation coverage'.

