---
id: f-966c
status: open
deps: [f-7648]
links: []
created: 2026-01-25T11:09:07Z
type: task
priority: 2
assignee: Adam Avenir
parent: f-d1ae
---
# Phase 5: Add tests for chat thread commands

Add coverage for internal/chat/commands_thread.go before refactor.

Test targets (suggested):
- isRoomDestination: validates room/thread name rules.
- isAncestorOf: returns true for ancestor chain and errors on cycles (use temp DB threads).
- checkMetaPathCollision: rejects meta/ path collisions.
- runThreadCommand/runSubthreadCommand/createThread: validate error cases and JSONL/thread creation via temp project.
- runMvThreadCommand: move thread updates parent + anchor as expected (mock minimal model/db).

Use existing chat test helpers and temp db setup patterns.

## Acceptance Criteria

New tests in internal/chat (e.g., commands_thread_test.go) cover thread creation/move helpers. go test ./internal/chat -run ThreadCommand passes. Commit with message like 'test(chat): add thread command coverage'.

