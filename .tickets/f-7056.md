---
id: f-7056
status: open
deps: [f-3c7a]
links: []
created: 2026-01-25T11:08:51Z
type: task
priority: 2
assignee: Adam Avenir
parent: f-d1ae
---
# Phase 4: Add tests for init command

Add coverage for init flows before refactor.

Test targets (suggested):
- init --defaults: creates .fray config with channel id/name, sets db config values, and registers channel.
- ensureLLMRouter: creates llm/ router template + prompt templates when missing.
- createManagedAgent: inserts managed agent + JSONL append.
- joinExistingProject: default join selections and output when project already initialized.
- prompt helpers: defaultJoinSelections/formatCapabilities/formatLastActive (pure).

Use temp project dirs; keep tests hermetic.

## Acceptance Criteria

New tests in internal/command (e.g., init_test.go) cover defaults init and llm router creation. go test ./internal/command -run Init passes. Commit with message like 'test(command): add init coverage'.

