---
id: f-8924
status: open
deps: [f-fed4]
links: []
created: 2026-01-25T05:33:09Z
type: task
priority: 2
assignee: Adam Avenir
parent: f-9a7e
---
# Phase 1: Split internal/db/jsonl_read.go by entity

Split read paths into per-entity files and a shared helper file.

Suggested files
- internal/db/jsonl_read_common.go: readJSONLLines, readJSONLFile, shared parsing helpers, ordering helpers.
- internal/db/jsonl_read_messages.go: ReadMessages, ReadMessagePins, GetMessageVersions, GetMessageEditCounts, ApplyMessageEditCounts + message helpers.
- internal/db/jsonl_read_threads.go: ReadThreads, ReadThreadPins, ReadThreadMutes + helpers.
- internal/db/jsonl_read_agents.go: ReadAgents, ReadAgentDescriptors + helpers.
- internal/db/jsonl_read_questions.go: ReadQuestions + helpers.
- internal/db/jsonl_read_reactions.go: ReadReactions + helpers.
- internal/db/jsonl_read_roles.go: ReadRoles + helpers.
- internal/db/jsonl_read_permissions.go: ReadPermissions, ReadPermissionByGUID.
- internal/db/jsonl_read_wake.go: ReadWakeConditions/trigger events if present.
- internal/db/jsonl_read_jobs.go: job-related reads if present.

Keep package API stable; only move code.

## Acceptance Criteria

Files split as above (names may vary but by-entity split exists).
All jsonl_read tests pass.
Tests: go test ./internal/db/...
Commit: refactor(db): split jsonl_read by entity

