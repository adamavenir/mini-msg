---
id: f-e691
status: closed
deps: [f-e5b2, f-0ee7]
links: []
created: 2026-01-24T05:06:54Z
type: task
priority: 1
assignee: Adam Avenir
parent: f-4001
tags: [multi-machine, phase3]
---
# Phase 3: Agent add/remove commands

Implement fray agent add/remove commands for managing local agent registration.

**Context**: Read docs/MULTI-MACHINE-SYNC-PLAN.md section 3.3.

**Files to modify**: internal/command/agent.go (or similar)

**Commands**:
```bash
fray agent add <name>              # Register remote agent locally
fray agent add <name> --driver claude --model opus-4
fray agent remove <name>           # Stop running locally (keeps history)
```

**fray agent add**:
1. Check agent exists in shared data (has messages or descriptor)
2. Prompt for driver/model config
3. Write agent registration to local/runtime.jsonl
4. Agent now appears in local agent list

**fray agent remove**:
1. Mark agent as removed in local/runtime.jsonl
2. Agent no longer runs locally
3. History and shared data preserved

**Tests required**:
- Test add registers agent locally
- Test add prompts for config
- Test remove marks agent as removed
- Test history is preserved after remove

## Acceptance Criteria

- Agent add command implemented
- Agent remove command implemented
- Registration in local/runtime.jsonl
- Unit tests pass
- go test ./... passes
- Changes committed

